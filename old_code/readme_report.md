# ２行軌道要素形式を用いた衛星の軌道解析用プログラム

##  概要
　今回の最終課題の課題設定の動機としては、せっかく航空宇宙工学科の授業なので航空宇宙にちなんだものを作成したいという思いがあった。そこで、２年Aセメスターで履修した「宇宙工学入門」において登場したTLE（２行軌道要素形式）を用いて実際に軌道計算を行ってみようと思い立ち当該プログラムを作成した。
　TLEは、NASAやアメリカ航空宇宙防衛司令部（NORAD）が使用している人工衛星の地心座標系における軌道形式のフォーマットである。軌道要素についての情報（Line1とLine2）のことをさしているが衛星の名称等（Line0）を含むこともある。今回のプログラムではグローバル変数tleにTLEを入力しておけば衛星軌道の遷移を３Dで出力できることを目指した。Spyderでインタラクティブにtleを編集できればよかったが時間の関係上断念した。
　プログラムを作成していく上で見えてきた今後の課題としてはtleを編集しやすくすること、地球から見た衛星の位置をわかりやすくする（世界地図上にプロットする）ことなどが挙げられた。
TLEの一般的なフォーマットは図１の通りである。

- 当該プログラムにおいてelementの各軌道要素は以下である
    - 00 行数（１）
    - 01 衛星通し番号と公開か否か
    - 02 国際衛星識別符号
    - 03 軌道元期（２桁年＋日単位。最小桁の制度は0.864ms）
    - 04 平均運動の１時微分値の２分の１（回転/day^2）
    - 05 ２次微分の６分の１（回転/day^3）使用されない
    - 06 B*抗力項下２桁は１０の指数
    - 07 軌道モデル種別
    - 08 軌道要素通番+チェックサム（下１桁）
    - 09 行数（２）
    - 10 カタログ番号（01から"S"または"U"を消去したもの）
    - 11 軌道傾斜角
    - 12 昇交点赤経
    - 13 離心率
    - 14 近地点引数
    - 15 平均近点角
    - 16 平均運動＋通算周期数（４桁）＋チェックサム（下１桁）

##  プログラムの解説
　まず、テキスト形式で入力されたTLEを各要素ごとに配列内に入れる。今回は気象衛星「みどり」のものを使用した。TLEは以下。

MIDORI (ADEOS)          

1 24277U 96046A   09116.47337938 -.00000023  00000-0  73445-5 0   432

2 24277  98.3597  83.2073 0002090  64.7512 295.3886 14.28595439661547

工夫した点としては、element01に含まれるアルファベットはS（secret）かU（unclassified）であること、element10はelement01からアルファベットを消去したものであることから配列の要素を軌道要素に１対１対応させるようにしていることが挙げられる。

　次に衛星の軌道長半径・衛星高度をelement16,element04を用いてケプラーの第３法則により算出した。

　算出された長半径及びelement15,16,04を用いて時刻deltaにおける平均近点角を算出し、これと離心率（element13）を用いてニュートン法により軌道の離心近点角を求値した。

　算出した離心近点角・軌道長半径・離心率によって軌道内の衛星の位置がわかる。これを３次元回転行列によって地心座標に座標変換をして衛星の位置を求めている。この際、回転角は近地点引数（element14）昇交点赤経（element12）を時間に関して補正したもの、及び軌道傾斜角（element11）を使用している。

　これらのプログラムを時間経過delta_tごとに実行することで衛星の軌道を算出してmatplotlibによって３次元プロットしている。時刻０の時の点を黒点で強調した。結果については巻末に図を添付する。

##  実行結果


図２　衛星の軌道（時刻０から一周するまで）

図３　軌道の時間遷移（軌道面が回転していることがわかる）

##  出典
人工衛星位置推算の実際（最終版）（2017年８月７日アクセス）
http://www.infra.kochi-tech.ac.jp/takagi/Geomatics/5Estimation2.pdf
NORAD Two-Line Element Set Format(２０１７年８月７日アクセス)
http://celestrak.com/NORAD/documentation/tle-fmt.asp
Definition of Two-line Element Set Coordinate System(NASA)（2017年８月７日アクセス）
https://spaceflight.nasa.gov/realdata/sightings/SSapplications/Post/JavaSSOP/SSOP_Help/tle_def.html
